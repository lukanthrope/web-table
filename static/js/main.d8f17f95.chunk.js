(this["webpackJsonpweb-table"]=this["webpackJsonpweb-table"]||[]).push([[0],{15:function(e,t,n){e.exports=n(29)},20:function(e,t,n){},26:function(e,t,n){},28:function(e,t,n){},29:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),l=n(3),c=n.n(l),o=(n(20),n(1)),u=n(2),i=function(){var e=Object(o.c)((function(e){return e.get("activeCell")})),t=s(e),n=Object(u.a)(t,2),a=n[0];return{activeCell:e,setActiveCellValue:n[1],activeCellValue:a}},f=function(e){return{type:"SET_ACTIVE_CELL",payload:e}},s=function(e){var t=Object(o.c)((function(t){return t.get("table")[e].value})),n=Object(o.b)();return[t,function(t){n({type:"UPDATE_CELL",payload:{cell:e,data:t}})}]},v=function(e){var t=Object(o.c)((function(t){return t.get("table")[e].style})),n=Object(o.b)();return[t,function(t,a){n({type:"UPDATE_CELL_STYLE",payload:{cell:e,param:t,value:a}})}]},b=n(12);function m(e){var t=function(e){var t=0;return e.split("").map((function(e){return!((n=e)>="0"&&n<="9")&&t++;var n})),t}(e),n=e.substring(0,t),a=Number(e.substring(t))+1;return a>100&&(a=1),"".concat(n).concat(a)}function d(e){for(var t=-1,n=-1,a=Math.floor(e.length/2),r=a,l=a;e.length,l>=0;r++,l--){if("("===e[r]){t=r;break}if("("===e[l]){t=l;break}}for(var c=0,o=t+1;o<e.length;o++)if("("===e[o]&&c++,")"===e[o]){if(0===c){n=o;break}c--}return{output:e.substring(t+1,n),rest:"".concat(e.substring(0,t)).concat(e.substring(n+1))}}var g=function(e){return"+"===e||"-"===e||"*"===e||"/"===e};function p(e,t,n){switch(e){case"+":return t+n;case"-":return t-n;case"/":return t/n;default:return t*n}}var E=function(e){var t=e.trim(),n=function(e){var t,n=[],a=d(e),r=a.rest;for(n.push(a.output);(t=r).includes("(")&&t.includes(")");)r=(a=d(r)).rest,n.push(a.output);return n.push(r),n}(t);if(!function(e){var t,n=[],a=Object(b.a)(e);try{for(a.s();!(t=a.n()).done;){var r=t.value,l="[]{}()<>".indexOf(r);if(-1!==l)if(l%2===0)n.push(l+1);else if(n.pop()!==l)return!1}}catch(c){a.e(c)}finally{a.f()}return 0===n.length}(t))return"Syntax error";console.log(n);for(var a=0,r="",l="",c="",o=0;o<n.length;o++){var u=n[o],i=u.length-1;console.log(u[i]),g(u[i])&&(u="".concat(u[i]).concat(u.substring(0,i))),r=a.toString(),console.log(u);for(var f=0;f<u.length;f++)console.log(c),f===u.length-1?isNaN(Number(l+u[f]))||isNaN(Number(r))||""===c||(r=(a=p(c,Number(r),Number(l+u[f]))).toString(),l=""):isNaN(Number(r+u[f]))||""!==c?isNaN(Number(l+u[f]))||""===c?g(u[f])&&(isNaN(Number(l))||isNaN(Number(r))||""===c||(r=(a=p(c,Number(r),Number(l))).toString(),l=""),c=u[f]):l+=u[f]:r+=u[f]}return a.toString()};var h=function(){var e=i(),t=e.setActiveCellValue,n=e.activeCellValue,a=Object(o.c)((function(e){return e.get("table")}));return r.a.createElement("div",null,r.a.createElement("span",null,"fx"),r.a.createElement("input",{value:n,onChange:function(e){return t(e.target.value)},"data-testid":"header-input",onKeyDown:function(e){if("Enter"===e.key){var r=n.toLowerCase();for(var l in a){var c=l.toLowerCase();r.includes(c)&&(r=r.replace(new RegExp(c,"g"),a[l].value))}t(E(r))}}}))},y=function(e,t){return e===t},C=function(e,t){return e?t:""};var N=function(){var e=i().activeCell,t=v(e),n=Object(u.a)(t,2),a=n[0],l=n[1],c=a.fontWeight,o=a.fontStyle,f=a.background,s=a.color;return r.a.createElement("div",{className:"tool-bar"},r.a.createElement("div",null,r.a.createElement("label",null,"background"),r.a.createElement("input",{type:"color",value:f,onChange:function(e){l("background",e.target.value)}})),r.a.createElement("div",null,r.a.createElement("label",null,"font"),r.a.createElement("input",{type:"color",value:s,onChange:function(e){l("color",e.target.value)}})),r.a.createElement("section",null,r.a.createElement("span",{className:"material-icons pointer graybg-hover ".concat(C(y(c,"bold"),"graybg")),onClick:function(){y(c,"bold")?l("fontWeight","normal"):l("fontWeight","bold")}},"format_bold"),r.a.createElement("span",{className:"material-icons pointer graybg-hover ".concat(C(y(o,"italic"),"graybg")),onClick:function(){y(o,"italic")?l("fontStyle","normal"):l("fontStyle","italic")}},"format_italic")))},k=(n(26),function(e){return r.a.createElement("header",null,null===e||void 0===e?void 0:e.children)}),O=n(13);var j=function(e){var t=e.cellId,n=Object(o.b)(),l=Object(a.useRef)(null),c=i().activeCell,b=s(t),d=Object(u.a)(b,2),g=d[0],p=d[1],E=v(t),h=Object(u.a)(E,1)[0],y=h.background,C=h.color,N=h.fontWeight,k=h.fontStyle,j=Object(O.debounce)((function(e){"Enter"===e.key&&S(),"Tab"===e.key&&S()}),500);Object(a.useEffect)((function(){var e;c===t&&(null===(e=l.current)||void 0===e||e.focus())}),[c,t]);var S=function(){n(f({activeCell:m(c)}))};return r.a.createElement("td",{id:c===t?"active-cell":""},r.a.createElement("input",{value:g,onChange:function(e){return p(e.target.value)},onClick:function(){n(f({activeCell:t}))},onKeyDown:function(e){"Tab"!==e.key&&"Enter"!==e.key||(e.persist(),e.preventDefault(),j(e))},ref:l,"data-testid":t,style:{background:y,color:C,fontStyle:k,fontWeight:N}}))};var S=function(e){var t=e.names;return r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null),t.map((function(e){return r.a.createElement("th",{key:e,className:"t-header"},e)}))))};n(28);var w=function(){var e=Object(a.useState)([]),t=Object(u.a)(e,2),n=t[0],l=t[1],c=Object(a.useState)([]),o=Object(u.a)(c,2),i=o[0],f=o[1];return Object(a.useEffect)((function(){!function(){for(var e=[],t=65;t<=90;t++)e.push(String.fromCharCode(t));l(e)}(),function(){for(var e=[],t=1;t<=100;t++)e.push(t);f(e)}()}),[]),r.a.createElement("div",{className:"table-container"},r.a.createElement("table",{className:"table"},r.a.createElement(S,{names:n}),r.a.createElement("tbody",null,i.map((function(e){return r.a.createElement("tr",{key:e},r.a.createElement("th",{className:"row-header"},e),n.map((function(t){return r.a.createElement(j,{key:"".concat(t).concat(e),cellId:"".concat(t).concat(e)})})))})))))};var L=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(k,null,r.a.createElement(N,null),r.a.createElement(h,null)),r.a.createElement(w,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var T=n(4),_=n(14),A=function(){for(var e={},t=64,n="",a=1;a<27;a++){t++,n=String.fromCharCode(t);for(var r=1;r<=100;r++)e["".concat(n).concat(r)]={value:"",style:{background:"#ffffff",fontStyle:"normal",fontWeight:"normal",color:"#000000"}}}return e}(),W=Object(_.a)({table:A,activeCell:"A1"}),D=Object(T.b)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:W,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_CELL":return e.update("table",(function(e){return e[t.payload.cell].value=t.payload.data,e}));case"SET_ACTIVE_CELL":return e.set("activeCell",t.payload.activeCell);case"UPDATE_CELL_STYLE":return e.update("table",(function(e){var n=e[t.payload.cell].style;return n[t.payload.param]=t.payload.value,e[t.payload.cell].style=Object.assign({},n),e}));default:return e}}));c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(o.a,{store:D},r.a.createElement(L,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[15,1,2]]]);
//# sourceMappingURL=main.d8f17f95.chunk.js.map